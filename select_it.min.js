!function(a){a.fn.select_it=function(b){var e,c=[],d=0;return a(this).each(function(){if(a(this).parent("form")){var f=a(this).parent("form").children().length;console.log(f),f=""}c=[],d++;var g,h,i,j,k,l,m=a.extend({onchange:"none",onchange_url:"gallery_ajax.php",onchange_container:".gallery .carousel.block",returned_div:"toggled",placeholder:"...",tabindex:0},b),n=0;a(this).hide(),a(this).html(),l=a(this).attr("tabindex")?a(this).attr("tabindex"):m.tabindex,g=a(this).data("placeholder")?a(this).data("placeholder"):m.placeholder,a(this).find("option").each(function(){n++,1!=n&&a(this).is(":selected")&&(g=a(this).text())}),k=a(this).data("onchange")?a(this).data("onchange"):m.onchange,a(this).children("option").each(function(b){var d=a(this).val(),e=a(this).text();c[b]=['<li rel="'+d+'">'+e+"</li>"]}),c=c.join("\r"),a(this).after('<div id="select_'+d+'" class="select_it"><div class="select_it_box" tabindex="'+l+'"><span class="displayed">'+g+'</span><span class="tab"></span></div><ul style="display: none;">'+c+"</ul></div><!--/select_it-->"),a(".select_it .select_it_box").click(function(b){b.stopImmediatePropagation(),j=a(this).parents(".select_it").attr("id"),a("#"+j+" .select_it_box").hasClass("open")?(a(".select_it_box").removeClass("open"),a(".select_it ul").hide()):(a(".select_it_box").removeClass("open"),a(".select_it ul").hide(),a("#"+j+" .select_it_box").addClass("open"),a("#"+j+" ul").show())}),a(".select_it .select_it_box").keydown(function(b){return b.stopImmediatePropagation(),j=a(this).parents(".select_it").attr("id"),40==b.keyCode&&(a("#"+j+" .select_it_box").addClass("open"),e=0,a(".select_it ul li").each(function(){a(this).hasClass("selected")&&e++}),0===e?a("#"+j+" ul li:first-child").addClass("selected"):(a("#"+j+" ul li.selected").next().addClass("selected"),a("#"+j+" ul li.selected").first().removeClass("selected"),h=a("#"+j+" ul li.selected").html(),a("#"+j+" .select_it_box .displayed").html(h))),38==b.keyCode&&(e=0,a(".select_it ul li").each(function(){a(this).hasClass("selected")&&e++}),0===e?a("#"+j+" ul li:first-child").addClass("selected"):(a("#"+j+" ul li.selected").prev().addClass("selected"),a("#"+j+" ul li.selected").last().removeClass("selected"),h=a("#"+j+" ul li.selected").html(),a("#"+j+" .select_it_box .displayed").html(h))),j=a(this).parents(".select_it").attr("id"),13==b.keyCode&&(a(".select_it_box").removeClass("open"),a(".select_it ul").hide(),h=a("#"+j+" ul li.selected").html(),a("#"+j+" .select_it_box .displayed").html(h)),9==b.keyCode&&a("#"+j).parents("form > .fieldset .block").next().find("input, textarea").focus(),!1}),a(".select_it ul li").click(function(b){if(b.stopImmediatePropagation(),j=a(this).parents(".select_it").attr("id"),a("#"+j+" ul li").removeClass("selected"),a("#"+j+" ul").hide(),h=a(this).attr("rel"),selected_text=a(this).html(),a(this).addClass("selected"),a(this).parents("#"+j).prev("select").find("option").each(function(){i=a(this).val(),i==h&&(a(this).parents("select").find("option").removeAttr("selected"),a(this).attr("selected","selected"))}),a("#"+j).children(".select_it_box").removeClass("open"),a("#"+j+" .select_it_box .displayed").html(h),a("#"+j+" .select_it_box .displayed").html(selected_text),"toggle"==k){var c=a(this).attr("rel");a("."+m.returned_div).hide(),a("#"+c).show(200)}if("load"==k){a(m.onchange_container).html('<img class="loading" src="images/loading.gif" />');var d=a(this).attr("rel");console.log(d),a.ajax({url:m.onchange_url+"?id="+d,error:function(){console.log("fail")},success:function(b){a(m.onchange_container).html(b),a(m.onchange_container).data("owlCarousel").reinit({itemsCustom:[[0,3],[400,4]]})}})}if(console.log("testing"),console.log(k),"submit"==k){var e=a(this).closest("form");console.log(e),a(this).closest("form").submit()}})}),a(document).click(function(){a(".select_it .select_it_box").removeClass("open"),a(".select_it ul").hide()}),this}}(jQuery);